# SPDX-License-Identifier: Apache-2.0
# Fault monitor binding

description: |
  Fault monitor that checks signal conditions and outputs fault flags.
  
  Monitors a single input signal for various fault conditions:
  - Staleness: Signal hasn't updated within timeout
  - Range: Signal value outside min/max bounds  
  - Status: Signal has FAULT or INCONSISTENT status
  
  When any enabled fault condition is detected, sets the fault output
  signal to 1 (fault), otherwise 0 (OK).

compatible: "lq,fault-monitor"

properties:
  input-signal-id:
    type: int
    required: true
    description: Signal ID to monitor

  fault-output-signal-id:
    type: int
    required: true
    description: Signal ID for fault output (0=OK, 1=FAULT)

  check-staleness:
    type: boolean
    description: Enable staleness detection

  stale-timeout-us:
    type: int
    description: Staleness timeout in microseconds

  check-range:
    type: boolean
    description: Enable range checking

  min-value:
    type: int
    description: Minimum valid value

  max-value:
    type: int
    description: Maximum valid value

  check-status:
    type: boolean
    description: Check for FAULT/INCONSISTENT status from merges

  fault-level:
    type: int
    description: |
      Severity level when fault is detected (default: 1)
      0 = No fault (informational)
      1 = Warning / Soft fault
      2 = Error / Medium fault
      3 = Critical / Hard fault
      Higher levels available with LQ_MAX_FAULT_LEVELS config

  wake-function:
    type: string
    description: |
      Name of wake callback function to call when fault state changes.
      User must implement: void function_name(uint8_t monitor_id, 
                                               int32_t input_value, 
                                               enum lq_fault_level level)
      Use this for immediate safety actions (shutdown, limp mode, etc.)

  status:
    type: string
    description: "okay" to enable, "disabled" to disable
